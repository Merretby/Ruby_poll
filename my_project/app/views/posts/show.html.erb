<div class="max-w-4xl mx-auto space-y-6">
  <div>
    <%= link_to posts_path, class: 'text-gray-600 hover:text-gray-900' do %>
      ← Back to Posts
    <% end %>
  </div>

  <article class="bg-white rounded-lg shadow-lg overflow-hidden">
    <div class="bg-blue-600 px-8 py-12 text-white">
      <h1 class="text-4xl font-bold mb-4"><%= @post.title %></h1>
      <div class="flex items-center space-x-4 text-blue-100">
        <span>By <%= @post.user.author_name %></span>
        <span>•</span>
        <%= turbo_frame_tag dom_id(@post, :status) do %>
          <% if @post.published_at %>
            Published <%= time_ago_in_words(@post.published_at) %> ago
          <% else %>
            <span class="px-2 py-1 bg-yellow-500 rounded text-white text-sm">Draft</span>
          <% end %>
        <% end %>
      </div>
    </div>

    <div class="px-8 py-8">
      <div class="prose max-w-none text-gray-700">
        <%= simple_format(@post.body) %>
      </div>
    </div>

    <div id="<%= dom_id(@post, :actions) %>" class="px-8 py-4 bg-gray-50 border-t border-gray-200 flex gap-3">
      <% if allowed_to?(:publish?, @post) || allowed_to?(:unpublish?, @post) %>
        <% if @post.published? %>
          <%= link_to 'Unpublish', unpublish_post_path(@post), data: { turbo_method: :patch }, class: 'px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg' %>
        <% else %>
          <%= link_to 'Publish', publish_post_path(@post), data: { turbo_method: :patch }, class: 'px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg' %>
        <% end %>
      <% end %>
      <% if allowed_to?(:update?, @post) %>
        <%= link_to 'Edit', edit_post_path(@post), class: 'px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg' %>
      <% end %>
      <% if allowed_to?(:destroy?, @post) %>
        <%= link_to 'Delete', @post, data: { turbo_method: :delete }, class: 'px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg' %>
      <% end %>
    </div>
  </article>

  <div class="bg-white rounded-lg shadow-lg p-8">
    <h3 class="text-2xl font-bold text-gray-900 mb-6">Comments (<%= @post.comments.count %>)</h3>

    <div id="comments" class="space-y-4 mb-8">
      <%= render @post.comments %>
    </div>

    <div class="border-t border-gray-200 pt-6">
      <h4 class="text-lg font-semibold text-gray-900 mb-4">Add a Comment</h4>
      <%= form_with model: [@post, @post.comments.build], local: true, class: 'space-y-4' do |form| %>
        <div>
          <%= form.label :content, "Your comment:", class: 'block text-sm font-medium text-gray-700 mb-1' %>
          <%= form.text_area :content, rows: 4, required: true, placeholder: "Write your comment here...", class: 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500' %>
        </div>
        
        <div>
          <%= form.submit "Post Comment", class: 'px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg cursor-pointer' %>
        </div>
      <% end %>
    </div>
  </div>
</div>